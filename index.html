import React, { useState, useEffect } from "react";

const heartStyle = {
  color: "#FF4D6D",
  fontSize: "1.5rem",
  marginLeft: "0.3rem",
  marginRight: "0.3rem",
  animation: "heartBeat 1.5s infinite",
  display: "inline-block",
};

const arrowStyle = {
  fontSize: "2rem",
  color: "#B19CD9",
  marginRight: "0.5rem",
  animation: "arrowBounce 2s infinite",
};

const lilacCardStyle = {
  backgroundColor: "#C8A2C8",
  borderRadius: "15px",
  padding: "1.5rem",
  margin: "1rem auto",
  maxWidth: "400px",
  boxShadow: "0 0 15px rgba(200, 162, 200, 0.4)",
  color: "#5D3A6A",
  fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
  position: "relative",
};

const redHeartStyle = {
  position: "absolute",
  width: "12px",
  height: "12px",
  backgroundColor: "#FF3B58",
  clipPath:
    "polygon(50% 0%, 61% 13%, 75% 13%, 84% 25%, 84% 40%, 75% 50%, 50% 80%, 25% 50%, 16% 40%, 16% 25%, 25% 13%, 39% 13%)",
  animation: "heartFloat 6s ease-in-out infinite",
};

const redHeartSmall = {
  ...redHeartStyle,
  width: "8px",
  height: "8px",
  opacity: 0.8,
};

const lilacBackground = "#D7BDE2";
const softTextColor = "#4A235A";

const AnimatedLilies = () => {
  // simple lily animation with CSS shapes and slight scale/pulse animation
  return (
    <div
      style={{
        display: "flex",
        gap: 10,
        justifyContent: "center",
        marginTop: 20,
        marginBottom: 20,
      }}
      aria-label="Animated bouquet of blue lilies"
    >
      {[...Array(5)].map((_, i) => (
        <div
          key={i}
          className="lily"
          style={{
            width: 40,
            height: 60,
            background:
              "radial-gradient(circle at 20% 20%, #accbee, #2c3e50 80%)",
            borderRadius: "50% 50% 40% 40% / 60% 60% 40% 40%",
            position: "relative",
            animation: "pulseLily 3s ease-in-out infinite",
            animationDelay: `${i * 0.3}s`,
          }}
        >
          <div
            style={{
              position: "absolute",
              bottom: 0,
              left: "50%",
              width: 6,
              height: 30,
              backgroundColor: "#2c3e50",
              transform: "translateX(-50%)",
              borderRadius: 3,
            }}
          />
        </div>
      ))}
    </div>
  );
};

export default function App() {
  const [page, setPage] = useState(1);
  const [confetti, setConfetti] = useState(false);
  const [showFinalMessage, setShowFinalMessage] = useState(false);

  // Confetti animation trigger for page 6 if yes clicked
  useEffect(() => {
    if (confetti) {
      const timer = setTimeout(() => {
        setShowFinalMessage(true);
      }, 3000);
      return () => clearTimeout(timer);
    }
  }, [confetti]);

  // Heart animations keyframes as style tag
  // Lilies pulse, arrow bounce, hearts float and beat animations
  return (
    <>
      <style>{`
      @keyframes heartBeat {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.3); }
      }
      @keyframes arrowBounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
      }
      @keyframes heartFloat {
        0%, 100% { transform: translateY(0); opacity: 1; }
        50% { transform: translateY(-15px); opacity: 0.7; }
      }
      @keyframes pulseLily {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
      }
      @keyframes confettiFall {
        0% { opacity: 1; transform: translateY(0) rotate(0deg);}
        100% { opacity: 0; transform: translateY(300px) rotate(360deg);}
      }
      .confetti-piece {
        position: fixed;
        width: 10px;
        height: 10px;
        background-color: #FF4D6D;
        opacity: 1;
        animation-name: confettiFall;
        animation-timing-function: linear;
        animation-iteration-count: 1;
      }
      .confetti-piece:nth-child(odd) {
        background-color: #FFC3C3;
      }
      `}</style>

      <div
        style={{
          minHeight: "100vh",
          display: "flex",
          flexDirection: "column",
          alignItems: "center",
          justifyContent: "center",
          padding: 20,
          backgroundColor: page === 4 ? "#D2B48C" : "#fff0f6",
          fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          color: softTextColor,
          textAlign: "center",
        }}
      >
        {page === 1 && (
          <>
            <div style={{ fontSize: "1.2rem", marginBottom: 20 }}>
              <span style={arrowStyle}>➜</span>
              <span role="img" aria-label="music note" style={{fontSize: "1.5rem", color:"#B19CD9", animation: "heartBeat 2s infinite"}}>
                🎵
              </span>{" "}
              We are saving for the big question in case she says yes.
            </div>
            <button
              onClick={() => setPage(2)}
              style={{
                marginTop: 30,
                backgroundColor: "#B19CD9",
                border: "none",
                padding: "10px 20px",
                borderRadius: 12,
                color: "white",
                cursor: "pointer",
                fontWeight: "bold",
                fontSize: "1rem",
              }}
            >
              Next
            </button>
          </>
        )}

        {page === 2 && (
          <>
            <div style={{ ...lilacCardStyle, position: "relative" }}>
              {/* red hearts randomly placed */}
              {[...Array(7)].map((_, i) => {
                const pos = [
                  { top: 10, left: 20 },
                  { top: 40, left: 80 },
                  { top: 70, left: 25 },
                  { top: 130, left: 60 },
                  { top: 160, left: 15 },
                  { top: 210, left: 70 },
                  { top: 230, left: 40 },
                ];
                return (
                  <div
                    key={i}
                    style={{
                      ...redHeartSmall,
                      top: pos[i].top,
                      left: pos[i].left,
                      position: "absolute",
                    }}
                  />
                );
              })}

              <AnimatedLilies />
              <p style={{ fontWeight: "600", fontSize: "1.1rem" }}>
                First of all, flowers for my beautiful girl.
              </p>

              <p>Since we have started talking, my life has changed for the good.</p>
              <p>You bring out the best in me.</p>
              <p>I have so so much love for you in my heart that it doesn't fit.</p>
              <p>You're all my favourite songs trapped in a person.</p>
              <p>My heart is so full of you that I can hardly call it mine.</p>

              <p style={{ marginTop: 30, fontWeight: "700", fontSize: "1.2rem" }}>
                So what I'm trying to say is........
              </p>

              <p style={{ fontStyle: "italic", fontWeight: "600", lineHeight: 1.4 }}>
                My darling,
                <br />
                You will never be unloved by me.
                <br />
                You are too well tangled in my soul.
                <br />
                I love you.
              </p>

              <button
                onClick={() => setPage(3)}
                style={{
                  marginTop: 30,
                  backgroundColor: "#5D3A6A",
                  border: "none",
                  padding: "10px 20px",
                  borderRadius: 12,
                  color: "white",
                  cursor: "pointer",
                  fontWeight: "bold",
                  fontSize: "1rem",
                }}
              >
                Next
              </button>
            </div>
          </>
        )}

        {page === 3 && (
          <>
            <h2 style={{ color: "#6A1B9A", marginBottom: 20, fontWeight: "700" }}>
              Let's have some fun now
            </h2>

            <div
              style={{
                backgroundColor: "#F3E5F5",
                padding: 20,
                borderRadius: 15,
                maxWidth: 450,
                margin: "0 auto",
                boxShadow: "0 0 10px rgba(161, 136, 127, 0.3)",
              }}
            >
              <QuestionBlock
                question="Do I make your heart race?"
                options={[
                  "Yes",
                  "Yessssss",
                  "My heart skips a beat every time you say something romantic.",
                ]}
              />
              <QuestionBlock
                question="Would you want to be together for a really long time?"
                options={["yes", "yes of course", "OMG yessssss"]}
              />
              <QuestionBlock
                question="How much do you love me?"
                options={[
                  "not sure if I love you like that",
                  "I do love you but don't know how much",
                  "I love you so freaking much that I don't want to live without you.",
                ]}
              />
              <QuestionBlock
                question="Who am I to you?"
                options={["your lover", "your little baby"]}
              />
              <QuestionBlock
                question="So can I call you mine officially now?"
                options={["yes", "yessss", "yes I am all yours."]}
              />
            </div>
            <button
              onClick={() => setPage(4)}
              style={{
                marginTop: 30,
                backgroundColor: "#7B1FA2",
                border: "none",
                padding: "10px 20px",
                borderRadius: 12,
                color: "white",
                cursor: "pointer",
                fontWeight: "bold",
                fontSize: "1rem",
              }}
            >
              Next
            </button>
          </>
        )}

        {page === 4 && (
          <>
            <h2
              style={{
                color: "#4E342E",
                fontWeight: "700",
                marginBottom: 20,
                fontFamily: "'Georgia', serif",
              }}
            >
              The soundtrack of my feelings for you---
            </h2>
            <div
              style={{
                maxWidth: 500,
                margin: "0 auto",
                backgroundColor: "#F5F5DC",
                borderRadius: 15,
                padding: 15,
                boxShadow: "0 0 15px rgba(121, 85, 72, 0.3)",
              }}
            >
              <SpotifySong
                songUri="spotify:track:2xLMifQCjDGFmkHkpNLD9h"
                title="Make You Mine - PUBLIC"
              />
              <SpotifySong
                songUri="spotify:track:3raZY2OZaFbdtqGZ6u83Cr"
                title="Picture Us - T.J Wilkins"
              />
              <SpotifySong
                songUri="spotify:track:24JygzOLM0EmRQeGtFcIcG"
                title="Sweater Weather - The Neighbourhood"
              />
              <SpotifySong
                songUri="spotify:track:3FJ9vG6v4Sqep3g7qHSc3S"
                title="Strawberries & Cigarettes - Troye Sivan"
              />
              <SpotifySong
                songUri="spotify:track:3Vq5qOkDXj1hcQnT4bTvV6"
                title="Ehsan Tera Hoga Mujh Par - Mohammad Rafi"
              />
            </div>

            <button
              onClick={() => setPage(5)}
              style={{
                marginTop: 30,
                backgroundColor: "#6D4C41",
                border: "none",
                padding: "10px 20px",
                borderRadius: 12,
                color: "white",
                cursor: "pointer",
                fontWeight: "bold",
                fontSize: "1rem",
              }}
            >
              Next
            </button>
          </>
        )}

        {page === 5 && (
          <>
            <div
              style={{
                maxWidth: 500,
                backgroundColor: "#EDE7F6",
                padding: 30,
                borderRadius: 15,
                fontStyle: "italic",
                fontWeight: "600",
                boxShadow: "0 0 10px rgba(103, 58, 183, 0.2)",
                marginBottom: 30,
                color: "#4A148C",
              }}
            >
              You're mine, like dawn belongs to morning light,
              <br />
              Like shadows cling to twilight's gentle might,
              <br />
              Even if the winds of doubt and fear assail,
              <br />
              In your arms, my heart finds its haven still.
            </div>

            <button
              onClick={() => setPage(6)}
              style={{
                backgroundColor: "#7E57C2",
                border: "none",
                padding: "10px 20px",
                borderRadius: 12,
                color: "white",
                cursor: "pointer",
                fontWeight: "bold",
                fontSize: "1rem",
              }}
            >
              Next
            </button>
          </>
        )}

        {page === 6 && (
          <>
            {!confetti && !showFinalMessage && (
              <>
                <p
                  style={{
                    maxWidth: 450,
                    margin: "0 auto",
                    fontSize: "1.2rem",
                    marginBottom: 40,
                    fontWeight: "500",
                  }}
                >
                  You know… I always imagined asking you this in person — maybe
                  while holding your hand, with the world slowing down for a
                  second. But we’ve waited so long, and every day I feel more
                  sure about you. So here I am, not waiting anymore.....
                </p>

                <div
                  style={{
                    fontWeight: "900",
                    fontSize: "2rem",
                    color: "#B39DDB",
                    marginBottom: 30,
                    fontFamily: "'Comic Sans MS', cursive, sans-serif",
                    userSelect: "none",
                  }}
                >
                  <b style={{ color: "#7E57C2", textShadow: "1px 1px #D1C4E9" }}>
                    Will you be my girlfriend?
                  </b>
                </div>

                <div style={{ display: "flex", justifyContent: "center", gap: 20 }}>
                  <button
                    onClick={() => setConfetti(true)}
                    style={{
                      backgroundColor: "#F48FB1",
                      border: "none",
                      padding: "10px 25px",
                      borderRadius: 30,
                      color: "white",
                      fontWeight: "bold",
                      cursor: "pointer",
                      fontSize: "1.2rem",
                      display: "flex",
                      alignItems: "center",
                      gap: 8,
                    }}
                  >
                    Yes <span style={{ fontSize: "1.6rem" }}>❤️</span>
                  </button>
                  <button
                    onClick={() => setConfetti(true)}
                    style={{
                      backgroundColor: "#F06292",
                      border: "none",
                      padding: "10px 25px",
                      borderRadius: 30,
                      color: "white",
                      fontWeight: "bold",
                      cursor: "pointer",
                      fontSize: "1.2rem",
                      display: "flex",
                      alignItems: "center",
                      gap: 8,
                    }}
                  >
                    Yes, I love you <span style={{ fontSize: "1.6rem" }}>❤️</span>
                  </button>
                </div>
              </>
            )}

            {confetti && !showFinalMessage && <Confetti />}

            {showFinalMessage && (
              <div
                style={{
                  maxWidth: 450,
                  padding: 20,
                  backgroundColor: "#E1BEE7",
                  borderRadius: 20,
                  fontWeight: "600",
                  fontSize: "1.3rem",
                  color: "#4A148C",
                  boxShadow: "0 0 10px rgba(123, 31, 162, 0.5)",
                }}
              >
                Thanks for letting me love you. I would always cherish you my
                love. I love you.
              </div>
            )}
          </>
        )}
      </div>
    </>
  );
}

function QuestionBlock({ question, options }) {
  return (
    <div
      style={{
        marginBottom: 20,
       
